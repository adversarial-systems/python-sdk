"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[342],{7867:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>g,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var r=i(5893),a=i(1151);const s={sidebar_position:1},t="Grabbing Images",o={id:"building-applications/grabbing-images",title:"Grabbing Images",description:"Groundlight's SDK accepts images in many popular formats, including PIL, OpenCV, and numpy arrays.",source:"@site/docs/building-applications/2-grabbing-images.md",sourceDirName:"building-applications",slug:"/building-applications/grabbing-images",permalink:"/python-sdk/docs/building-applications/grabbing-images",draft:!1,unlisted:!1,editUrl:"https://github.com/groundlight/python-sdk/tree/main/docs/docs/building-applications/2-grabbing-images.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Sample Applications",permalink:"/python-sdk/docs/building-applications/sample-applications"},next:{title:"Working with Detectors",permalink:"/python-sdk/docs/building-applications/working-with-detectors"}},d={},l=[{value:"PIL",id:"pil",level:2},{value:"OpenCV",id:"opencv",level:2},{value:"Numpy",id:"numpy",level:2},{value:"Channel order: BGR vs RGB",id:"channel-order-bgr-vs-rgb",level:3},{value:"Framegrab",id:"framegrab",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"grabbing-images",children:"Grabbing Images"}),"\n",(0,r.jsx)(n.p,{children:"Groundlight's SDK accepts images in many popular formats, including PIL, OpenCV, and numpy arrays."}),"\n",(0,r.jsx)(n.h2,{id:"pil",children:"PIL"}),"\n",(0,r.jsxs)(n.p,{children:["The Groundlight SDK can accept PIL images directly in ",(0,r.jsx)(n.code,{children:"submit_image_query"}),".  Here's an example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from groundlight import Groundlight\nfrom PIL import Image\n\ngl = Groundlight()\ndet = gl.get_or_create_detector(name="path-clear", query="Is the path clear?")\npil_img = Image.open("./docs/static/img/doorway.jpg")\ngl.submit_image_query(det, pil_img)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"opencv",children:"OpenCV"}),"\n",(0,r.jsxs)(n.p,{children:["OpenCV is a popular image processing library, with many utilities for working with images.\nOpenCV images are stored as numpy arrays.  (Note they are stored in BGR order, not RGB order, but as of Groundlight SDK v0.8 this is the expected order.)\nOpenCV's images can be send directly to ",(0,r.jsx)(n.code,{children:"submit_image_query"})," as follows:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"notest",children:"import cv2\n\ncam = cv2.VideoCapture(0)  # Initialize camera (0 is the default index)\n\n_, frame = cam.read()  # Capture one frame\ngl.submit_image_query(detector, frame)  # Send the frame to Groundlight\ncam.release()  # Release the camera\n"})}),"\n",(0,r.jsx)(n.h2,{id:"numpy",children:"Numpy"}),"\n",(0,r.jsxs)(n.p,{children:["The Groundlight SDK can accept images as ",(0,r.jsx)(n.code,{children:"numpy"})," arrays. They should be in the standard HWN format in BGR color order, matching OpenCV standards.\nPixel values should be from 0-255 (not 0.0-1.0 as floats). So ",(0,r.jsx)(n.code,{children:"uint8"})," data type is preferable since it saves memory."]}),"\n",(0,r.jsx)(n.p,{children:"Here's sample code to create an 800x600 random image in numpy:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"notest",children:"import numpy as np\n\nnp_img = np.random.uniform(low=0, high=255, size=(600, 800, 3)).astype(np.uint8)\n# Note: channel order is interpretted as BGR not RGB\ngl.submit_image_query(detector, np_img)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"channel-order-bgr-vs-rgb",children:"Channel order: BGR vs RGB"}),"\n",(0,r.jsx)(n.p,{children:"Groundlight expects images in BGR order, because this is standard for OpenCV, which uses numpy arrays as image storage.\n(OpenCV uses BGR because it was originally developed decades ago for compatibility with the BGR color format used by many cameras and image processing hardware at the time of its creation.)\nMost other image libraries use RGB order, so if you are using images as numpy arrays which did not originate from OpenCV you likely need to reverse the channel order before sending the images to Groundlight.\nNote this change was made in v0.8 of the Groundlight SDK - in previous versions, RGB order was expected."}),"\n",(0,r.jsx)(n.p,{children:"If you have an RGB array, you must reverse the channel order before sending it to Groundlight, like:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:"notest",children:"# Convert numpy image in RGB channel order to BGR order\nbgr_img = rgb_img[:, :, ::-1]\n"})}),"\n",(0,r.jsx)(n.p,{children:"The difference can be surprisingly subtle when red and blue get swapped.  Often images just look a little off, but sometimes they look very wrong."}),"\n",(0,r.jsxs)(n.p,{children:["Here's an example of a natural-scene image where you might think the color balance is just off:\n",(0,r.jsx)(n.img,{alt:"Correct color order",src:i(2e3).Z+"",width:"800",height:"600"}),"\n",(0,r.jsx)(n.img,{alt:"Swapped color channels",src:i(9337).Z+"",width:"800",height:"600"})]}),"\n",(0,r.jsxs)(n.p,{children:["In industrial settings, the difference can be almost impossible to detect without prior knowledge of the scene:\n",(0,r.jsx)(n.img,{alt:"Correct color order",src:i(6033).Z+"",width:"1418",height:"979"}),"\n",(0,r.jsx)(n.img,{alt:"Swapped color channels",src:i(2239).Z+"",width:"1418",height:"979"})]}),"\n",(0,r.jsx)(n.h2,{id:"framegrab",children:"Framegrab"}),"\n",(0,r.jsxs)(n.p,{children:["For a unified interface to many different kinds of image sources, see the ",(0,r.jsx)(n.a,{href:"https://pypi.org/project/framegrab/",children:"framegrab library"}),".\nFramegrab is still an early work in progress, but has many useful features for working with cameras and other image sources.  Framegrab provides a single interface for many different kinds of image sources, including:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"USB cameras"}),"\n",(0,r.jsx)(n.li,{children:"IP cameras"}),"\n",(0,r.jsx)(n.li,{children:"Video files"}),"\n",(0,r.jsx)(n.li,{children:"Image files"}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},2239:(e,n,i)=>{i.d(n,{Z:()=>r});const r=i.p+"assets/images/cnc-gripper-bgr-3f62a203a84000db8dffb8b542aa8706.jpg"},6033:(e,n,i)=>{i.d(n,{Z:()=>r});const r=i.p+"assets/images/cnc-gripper-4e667290978a62db9edcb5859e42da1b.jpg"},9337:(e,n,i)=>{i.d(n,{Z:()=>r});const r=i.p+"assets/images/michonne-bgr-b7e5ce1b0ea7a8fad1386bb13f0b13cb.jpg"},2e3:(e,n,i)=>{i.d(n,{Z:()=>r});const r=i.p+"assets/images/michonne-d62a9f110b7dab2a04b1dca75c5cf39c.jpg"},1151:(e,n,i)=>{i.d(n,{Z:()=>o,a:()=>t});var r=i(7294);const a={},s=r.createContext(a);function t(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);